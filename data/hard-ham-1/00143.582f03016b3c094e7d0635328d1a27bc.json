{"id":"00143","group":"hard-ham-1","checksum":{"type":"MD5","value":"582f03016b3c094e7d0635328d1a27bc"},"text":"Received: from geb.spit.gen.nz (geb.spit.gen.nz [210.55.106.161])\n\tby dogma.slashnull.org (8.11.6/8.11.6) with ESMTP id g6N1Tc414637\n\tfor <spamistehsuk@spamtraps.taint.org>; Tue, 23 Jul 2002 02:29:38 +0100\nReceived: from shifty by geb.spit.gen.nz with local (Exim 3.35 #1 (Debian))\n\tid 17WoTo-0002EQ-00\n\tfor <spamistehsuk@spamtraps.taint.org>; Tue, 23 Jul 2002 13:28:48 +1200\nReceived: from mail by geb.spit.gen.nz with spam-scanned (Exim 3.35 #1 (Debian))\n\tid 17WoTm-0002ED-00\n\tfor <shifty@spit.gen.nz>; Tue, 23 Jul 2002 13:28:47 +1200\nReceived: from firewater.ihug.co.nz ([203.109.253.55])\n\tby geb.spit.gen.nz with esmtp (Exim 3.35 #1 (Debian))\n\tid 17WoTl-0002E6-00\n\tfor <shifty@spit.gen.nz>; Tue, 23 Jul 2002 13:28:45 +1200\nReceived: from scanner1.ihug.co.nz (scanner1.ihug.co.nz [203.109.254.21])\n\tby firewater.ihug.co.nz (8.9.2/8.9.2) with ESMTP id NAA13877\n\tfor <b.addis@staff.ihug.co.nz>; Tue, 23 Jul 2002 13:28:44 +1200 (NZST)\nReceived: from localhost ([127.0.0.1] helo=grunt2.ihug.co.nz)\n\tby scanner1.ihug.co.nz with esmtp (Exim 3.12 #1 (Debian))\n\tid 17WoTk-0003Uv-00\n\tfor <b.addis@staff.ihug.co.nz>; Tue, 23 Jul 2002 13:28:44 +1200\nReceived: from canaveral.red.cert.org [192.88.209.11] \n\tby grunt2.ihug.co.nz with esmtp (Exim 3.35 #1 (Debian))\n\tid 17WoTX-0004oQ-00; Tue, 23 Jul 2002 13:28:32 +1200\nReceived: from localhost (lnchuser@localhost)\n\tby canaveral.red.cert.org (8.9.3/8.9.3/1.12) with SMTP id TAA16990;\n\tMon, 22 Jul 2002 19:11:24 -0400 (EDT)\nDate: Mon, 22 Jul 2002 19:11:24 -0400 (EDT)\nReceived: by canaveral.red.cert.org; Mon, 22 Jul 2002 19:05:32 -0400\nMessage-Id: <CA-2002-21.1@cert.org>\nFrom: CERT Advisory <cert-advisory@cert.org>\nTo: cert-advisory@cert.org\nOrganization: CERT(R) Coordination Center - +1 412-268-7090\nList-Help: <http://www.cert.org/>, <mailto:Majordomo@cert.org?body=help>\nList-Subscribe: <mailto:Majordomo@cert.org?body=subscribe%20cert-advisory>\nList-Unsubscribe: <mailto:Majordomo@cert.org?body=unsubscribe%20cert-advisory>\nList-Post: NO (posting not allowed on this list)\nList-Owner: <mailto:cert-advisory-owner@cert.org>\nList-Archive: <http://www.cert.org/>\nSubject: CERT Advisory CA-2002-21 Vulnerability in PHP\nX-IHUG-iSpy: Doesn't appear to be Spam\nX-Rcpt-To: shifty@spit.gen.nz\nSender: Brent Addis <shifty@spit.gen.nz>\n\n\n\n-----BEGIN PGP SIGNED MESSAGE-----\n\nCERT Advisory CA-2002-21 Vulnerability in PHP\n\n   Original release date: July 22, 2002\n   Last revised: --\n   Source: CERT/CC\n\n   A complete revision history can be found at the end of this file.\n\nSystems Affected\n\n     * Systems running PHP versions 4.2.0 or 4.2.1\n\nOverview\n\n   A  vulnerability  has been discovered in PHP. This vulnerability could\n   be  used  by  a remote attacker to execute arbitrary code or crash PHP\n   and/or the web server.\n\nI. Description\n\n   PHP  is  a  popular  scripting  language  in  widespread use. For more\n   information about PHP, see\n\n          http://www.php.net/manual/en/faq.general.php\n\n   The  vulnerability  occurs  in the portion of PHP code responsible for\n   handling  file uploads, specifically multipart/form-data. By sending a\n   specially  crafted  POST  request  to  the web server, an attacker can\n   corrupt  the  internal  data  structures used by PHP. Specifically, an\n   intruder  can  cause  an improperly initialized memory structure to be\n   freed.  In  most  cases, an intruder can use this flaw to crash PHP or\n   the  web  server. Under some circumstances, an intruder may be able to\n   take  advantage  of  this  flaw  to  execute  arbitrary  code with the\n   privileges of the web server.\n\n   You  may  be  aware that freeing memory at inappropriate times in some\n   implementations  of  malloc  and  free  does not usually result in the\n   execution  of  arbitrary  code.  However, because PHP utilizes its own\n   memory  management  system,  the  implementation of malloc and free is\n   irrelevant to this problem.\n\n   Stefan  Esser  of  e-matters  GmbH has indicated that intruders cannot\n   execute   code   on   x86   systems.   However,  we  encourage  system\n   administrators  to  apply  patches  on  x86  systems  as well to guard\n   against denial-of-service attacks and as-yet-unknown attack techniques\n   that may permit the execution of code on x86 architectures.\n\n   This  vulnerability  was discovered by e-matters GmbH and is described\n   in  detail  in  their  advisory.  The  PHP  Group  has  also issued an\n   advisory.  A list of vendors contacted by the CERT/CC and their status\n   regarding this vulnerability is available in VU#929115.\n\n   Although   this  vulnerability  only  affects  PHP  4.2.0  and  4.2.1,\n   e-matters  GmbH  has  previously  identified  vulnerabilities in older\n   versions  of  PHP.  If  you  are  running  older  versions  of PHP, we\n   encourage you to review\n   http://security.e-matters.de/advisories/012002.html\n\nII. Impact\n\n   A  remote  attacker can execute arbitrary code on a vulnerable system.\n   An  attacker  may not be able to execute code on x86 architectures due\n   to  the way the stack is structured. However, an attacker can leverage\n   this  vulnerability  to  crash PHP and/or the web server running on an\n   x86 architecture.\n\nIII. Solution\n\nApply a patch from your vendor\n\n   Appendix A contains information provided by vendors for this advisory.\n   As  vendors report new information to the CERT/CC, we will update this\n   section  and note the changes in our revision history. If a particular\n   vendor  is  not  listed  below,  we  have not received their comments.\n   Please contact your vendor directly.\n\nUpgrade to the latest version of PHP\n\n   If  a  patch  is  not  available  from your vendor, upgrade to version\n   4.2.2.\n\nDeny POST requests\n\n   Until  patches  or an update can be applied, you may wish to deny POST\n   requests.  The  following  workaround  is  taken from the PHP Security\n   Advisory:\n\n     If  the  PHP  applications on an affected web server do not rely on\n     HTTP POST input from user agents, it is often possible to deny POST\n     requests on the web server.\n\n     In  the  Apache  web server, for example, this is possible with the\n     following  code  included  in  the  main  configuration  file  or a\n     top-level .htaccess file:\n\n     <Limit POST>\n        Order deny,allow\n        Deny from all\n     </Limit>\n\n     Note  that an existing configuration and/or .htaccess file may have\n     parameters contradicting the example given above.\n\nDisable vulnerable service\n\n   Until  you  can upgrade or apply patches, you may wish to disable PHP.\n   As a best practice, the CERT/CC recommends disabling all services that\n   are not explicitly required. Before deciding to disable PHP, carefully\n   consider your service requirements.\n\nAppendix A. - Vendor Information\n\n   This  appendix  contains  information  provided  by  vendors  for this\n   advisory.  As  vendors  report new information to the CERT/CC, we will\n   update this section and note the changes in our revision history. If a\n   particular  vendor  is  not  listed  below, we have not received their\n   comments.\n\nApple Computer Inc.\n\n          Mac  OS  X  and  Mac  OS X Server are shipping with PHP version\n          4.1.2  which  does  not  contain the vulnerability described in\n          this alert.\n\nCaldera\n\n          Caldera  OpenLinux  does  not provide either vulnerable version\n          (4.2.0,  4.2.1)  of  PHP  in their products. Therefore, Caldera\n          products are not vulnerable to this issue.\n\nCompaq Computer Corporation\n\n          SOURCE:  Compaq Computer Corporation, a wholly-owned subsidiary\n          of  Hewlett-Packard  Company  and  Hewlett-Packard  Company  HP\n          Services Software Security Response Team\n          x-ref: SSRT2300 php post requests\n          At  the  time  of  writing  this  document, Compaq is currently\n          investigating   the   potential  impact  to  Compaq's  released\n          Operating System software products.\n          As  further  information  becomes available Compaq will provide\n          notice  of  the  availability  of any necessary patches through\n          standard  security bulletin announcements and be available from\n          your normal HP Services supportchannel.\n\nCray Inc.\n\n          Cray, Inc. does not supply PHP on any of its systems.\n\nDebian\n\n          Debian GNU/Linux stable aka 3.0 is not vulnerable.\n          Debian GNU/Linux testing is not vulnerable.\n          Debian GNU/Linux unstable is vulnerable.\n          The  problem  effects PHP versions 4.2.0 and 4.2.1. Woody ships\n          an  older  version  of  PHP  (4.1.2),  that doesn't contain the\n          vulnerable function.\n\nFreeBSD\n\n          FreeBSD  does not include any version of PHP by default, and so\n          is  not  vulnerable; however, the FreeBSD Ports Collection does\n          contain  the  PHP4  package. Updates to the PHP4 package are in\n          progress  and a corrected package will be available in the near\n          future.\n\nGuardian Digital\n\n          Guardian  Digital  has not shipped PHP 4.2.x in any versions of\n          EnGarde, therefore we are not believed to be vulnerable at this\n          time.\n\nHewlett-Packard Company\n\n          SOURCE:  Hewlett-Packard Company Security Response Team\n          At  the  time  of  writing  this  document,  Hewlett Packard is\n          currently  investigating  the potential impact to HP's released\n          Operating System software products.\n          As further information becomes available HP will provide notice\n          of  the  availability of any necessary patches through standard\n          security  bulletin  announcements  and  be  available from your\n          normal HP Services support channel.\n\nIBM\n\n          IBM  is  not vulnerable to the above vulnerabilities in PHP. We\n          do  supply the PHP packages for AIX through the AIX Toolbox for\n          Linux  Applications.  However,  these packages are at 4.0.6 and\n          also incorporate the security patch from 2/27/2002.\n\nMandrakesoft\n\n          Mandrake Linux does not ship with PHP version 4.2.x and as such\n          is  not  vulnerable.  The  Mandrake Linux cooker does currently\n          contain  PHP  4.2.1  and  will  be  updated shortly, but cooker\n          should  not be used in a production environment and no advisory\n          will be issued.\n\nMicrosoft Corporation\n\n          Microsoft  products  are not affected by the issues detailed in\n          this advisory.\n\nNetwork Appliance\n\n          No Netapp products are vulnerable to this.\n\nRed Hat Inc.\n\n          None  of  our commercial releases ship with vulnerable versions\n          of PHP (4.2.0, 4.2.1).\n\nSuSE Inc.\n\n          SuSE Linux is not vulnerable to this problem, as we do not ship\n          PHP 4.2.x.\n     _________________________________________________________________\n\n   The  CERT/CC acknowledges e-matters GmbH for discovering and reporting\n   this vulnerability.\n     _________________________________________________________________\n\n   Author: Ian A. Finlay.\n   ______________________________________________________________________\n\n   This document is available from:\n   http://www.cert.org/advisories/CA-2002-21.html\n   ______________________________________________________________________\n\nCERT/CC Contact Information\n\n   Email: cert@cert.org\n          Phone: +1 412-268-7090 (24-hour hotline)\n          Fax: +1 412-268-6989\n          Postal address:\n          CERT Coordination Center\n          Software Engineering Institute\n          Carnegie Mellon University\n          Pittsburgh PA 15213-3890\n          U.S.A.\n\n   CERT/CC   personnel   answer  the  hotline  08:00-17:00  EST(GMT-5)  /\n   EDT(GMT-4)  Monday  through  Friday;  they are on call for emergencies\n   during other hours, on U.S. holidays, and on weekends.\n\nUsing encryption\n\n   We  strongly  urge you to encrypt sensitive information sent by email.\n   Our public PGP key is available from\n   http://www.cert.org/CERT_PGP.key\n\n   If  you  prefer  to  use  DES,  please  call the CERT hotline for more\n   information.\n\nGetting security information\n\n   CERT  publications  and  other security information are available from\n   our web site\n   http://www.cert.org/\n\n   To  subscribe  to  the CERT mailing list for advisories and bulletins,\n   send  email  to majordomo@cert.org. Please include in the body of your\n   message\n\n   subscribe cert-advisory\n\n   *  \"CERT\"  and  \"CERT  Coordination Center\" are registered in the U.S.\n   Patent and Trademark Office.\n   ______________________________________________________________________\n\n   NO WARRANTY\n   Any  material furnished by Carnegie Mellon University and the Software\n   Engineering  Institute  is  furnished  on  an  \"as is\" basis. Carnegie\n   Mellon University makes no warranties of any kind, either expressed or\n   implied  as  to  any matter including, but not limited to, warranty of\n   fitness  for  a  particular purpose or merchantability, exclusivity or\n   results  obtained from use of the material. Carnegie Mellon University\n   does  not  make  any warranty of any kind with respect to freedom from\n   patent, trademark, or copyright infringement.\n     _________________________________________________________________\n\n   Conditions for use, disclaimers, and sponsorship information\n\n   Copyright 2002 Carnegie Mellon University.\n\n   Revision History\nJuly 22, 2002:  Initial release\n\n\n\n\n-----BEGIN PGP SIGNATURE-----\nVersion: PGP 6.5.8\n\niQCVAwUBPTyOVqCVPMXQI2HJAQGK6QQAp1rR7K18PNxpQZvqKPYWxyrtpiT8mmKN\nUuyERmOoX+5MAwH0hbAWCvVcyLH0gKGbTpBkRgToT8IEHZojwHCzqOaMM9kni/FG\nQEVeznLfBX4GIgZGPu0XWlph3ZqaayWln57eGueYZ26zBuriIUu2cUCmyYGQkqlI\ntuZdnDqUmR0=\n=+829\n-----END PGP SIGNATURE-----\n\n\n"}