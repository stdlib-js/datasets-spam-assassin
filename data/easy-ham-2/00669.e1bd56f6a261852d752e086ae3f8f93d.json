{"id":"00669","group":"easy-ham-2","checksum":{"type":"MD5","value":"e1bd56f6a261852d752e086ae3f8f93d"},"text":"From vulnwatch-return-399-jm=jmason.org@vulnwatch.org  Fri Jul 19 16:07:33 2002\nReturn-Path: <vulnwatch-return-399-yyyy=spamassassin.taint.org@vulnwatch.org>\nDelivered-To: yyyy@localhost.netnoteinc.com\nReceived: from localhost (localhost [127.0.0.1])\n\tby phobos.labs.netnoteinc.com (Postfix) with ESMTP id 39F87440C8\n\tfor <jm@localhost>; Fri, 19 Jul 2002 11:07:33 -0400 (EDT)\nReceived: from dogma.slashnull.org [212.17.35.15]\n\tby localhost with IMAP (fetchmail-5.9.0)\n\tfor jm@localhost (single-drop); Fri, 19 Jul 2002 16:07:33 +0100 (IST)\nReceived: from vikki.vulnwatch.org (IDENT:qmailr@[199.233.98.101]) by\n    dogma.slashnull.org (8.11.6/8.11.6) with SMTP id g6JF0wJ06633 for\n    <jm@jmason.org>; Fri, 19 Jul 2002 16:00:58 +0100\nReceived: (qmail 20041 invoked by alias); 19 Jul 2002 15:14:22 -0000\nMailing-List: contact vulnwatch-help@vulnwatch.org; run by ezmlm\nPrecedence: bulk\nList-Post: <mailto:vulnwatch@vulnwatch.org>\nList-Help: <mailto:vulnwatch-help@vulnwatch.org>\nList-Unsubscribe: <mailto:vulnwatch-unsubscribe@vulnwatch.org>\nList-Subscribe: <mailto:vulnwatch-subscribe@vulnwatch.org>\nDelivered-To: mailing list vulnwatch@vulnwatch.org\nDelivered-To: moderator for vulnwatch@vulnwatch.org\nReceived: (qmail 26938 invoked from network); 19 Jul 2002 01:06:49 -0000\nX-Authentication-Warning: Tempo.Update.UU.SE: ulfh owned process doing -bs\nDate: Fri, 19 Jul 2002 02:23:52 +0200 (CEST)\nFrom: Ulf Harnhammar <ulfh@update.uu.se>\nTo: bugtraq@securityfocus.com\nCc: vulnwatch@vulnwatch.org, full-disclosure@lists.netsys.com\nMessage-Id: <Pine.LNX.4.21.0207190219070.13803-100000@Tempo.Update.UU.SE>\nMIME-Version: 1.0\nContent-Type: TEXT/PLAIN; charset=iso-8859-1\nSubject: [VulnWatch] Geeklog XSS and CRLF Injection\nContent-Transfer-Encoding: 8bit\nX-MIME-Autoconverted: from QUOTED-PRINTABLE to 8bit by dogma.slashnull.org\n    id g6JF0wJ06633\n\nGeeklog XSS and CRLF Injection\n\n\nPROGRAM: Geeklog\nVENDOR: Tony Bibbs et al. <geeklog-devel@example.sourceforge.net>\nHOMEPAGE: http://geeklog.sourceforge.net/\nVULNERABLE VERSIONS: 1.3.5sr1, possibly earlier versions as well\nNOT VULNERABLE VERSIONS: 1.3.5sr2\nLOGIN REQUIRED: no\nSEVERITY: high\n\n\nDESCRIPTION:\n\n\"Geeklog is a 'blog', otherwise known as a Weblog. It allows\nyou to create your own virtual community area, complete with user\nadministration, story posting, messaging, comments, polls, calendar,\nweblinks, and more! It can run on many different operating systems,\nand uses PHP4 and MySQL.\"\n\n(direct quote from the program's homepage)\n\nGeeklog is published under the terms of the GNU General Public\nLicense.\n\n\nSECURITY HOLES:\n\n1) Geeklog has got an XSS hole that affects both the stories and\nthe comments. The program removes the HTML elements that are used\nfor scripting, but it fails to remove the HTML attributes that are\nused for the same purpose, which leads to this hole.\n\nOne example of an XSS attack would be:\n\n<b onMouseOver=\"self.location.href='http://localhost/geeklog/'\">life\nhas made her that much bolder now</b>\n\nWhen a victim moves the mouse pointer over the quote from \"Lady\nGodiva's Operation\", an intrinsic event occurs and the JavaScript\ncode is executed.\n\n(There is also an XSS issue in the search engine. It was reported\nby �ome1, and not by me.)\n\n2) Geeklog has got a CRLF Injection hole in User Profile: Send\nEmail. The users' mail addresses are meant to be secret, but by\nusing this hole, you can get someone's mail address anyway.\n\nThe problem is that you can add extra mail headers, by using a\nCRLF combination followed by an extra mail header in the Subject\nfield. One way to add them is saving the HTML document with the\nform, and changing the <input type=text name=subject> tag to a\ntextarea. After opening the edited document in a web browser, you\nenter a Subject line in the textarea, press Enter, and then you\nenter your extra mail header. When the mail is sent, that header\nwill be included. If the header in question is \"Bcc: <your own\nmail address>\", the message will silently be copied to you, thus\nrevealing the recipient's mail address without them knowing.\n\nI have described this type of problem in further detail\nin my \"CRLF Injection\" paper, which is available at\nhttp://cert.uni-stuttgart.de/archive/bugtraq/2002/05/msg00079.html\n\n\nCOMMUNICATION WITH VENDOR:\n\nThe vendor was contacted on the 1st of July. Version 1.3.5sr2,\nwhich does not have any of these security holes (neither mine nor\n�ome1's), was released on the 9th of July.\n\n\nRECOMMENDATION:\n\nI recommend that all administrators upgrade to version 1.3.5sr2.\n\n\n// Ulf Harnhammar\nulfh@update.uu.se\n\n\n"}