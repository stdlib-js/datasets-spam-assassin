{"id":"01349","group":"easy-ham-2","checksum":{"type":"MD5","value":"22ea9f2c5d135c39d01f56c830b15e41"},"text":"From bugtraq-return-5951-legit-lists-secfocus=jmason.org@securityfocus.com  Tue Aug  6 18:32:08 2002\nReturn-Path: <bugtraq-return-5951-legit-lists-secfocus=spamassassin.taint.org@securityfocus.com>\nDelivered-To: yyyy@localhost.netnoteinc.com\nReceived: from localhost (localhost [127.0.0.1])\n\tby phobos.labs.netnoteinc.com (Postfix) with ESMTP id 2B17B440CD\n\tfor <jm@localhost>; Tue,  6 Aug 2002 13:32:02 -0400 (EDT)\nReceived: from phobos [127.0.0.1]\n\tby localhost with IMAP (fetchmail-5.9.0)\n\tfor jm@localhost (single-drop); Tue, 06 Aug 2002 18:32:02 +0100 (IST)\nReceived: from outgoing.securityfocus.com (outgoing2.securityfocus.com\n    [66.38.151.26]) by dogma.slashnull.org (8.11.6/8.11.6) with ESMTP id\n    g76HWck12384 for <legit-lists-secfocus@jmason.org>; Tue, 6 Aug 2002\n    18:32:38 +0100\nReceived: from lists.securityfocus.com (lists.securityfocus.com\n    [66.38.151.19]) by outgoing.securityfocus.com (Postfix) with QMQP id\n    CEDFB8F371; Tue,  6 Aug 2002 09:16:23 -0600 (MDT)\nMailing-List: contact bugtraq-help@securityfocus.com; run by ezmlm\nPrecedence: bulk\nList-Id: <bugtraq.list-id.securityfocus.com>\nList-Post: <mailto:bugtraq@securityfocus.com>\nList-Help: <mailto:bugtraq-help@securityfocus.com>\nList-Unsubscribe: <mailto:bugtraq-unsubscribe@securityfocus.com>\nList-Subscribe: <mailto:bugtraq-subscribe@securityfocus.com>\nDelivered-To: mailing list bugtraq@securityfocus.com\nDelivered-To: moderator for bugtraq@securityfocus.com\nReceived: (qmail 10791 invoked from network); 6 Aug 2002 00:35:59 -0000\nDate: Mon, 5 Aug 2002 16:50:07 -0700 (PDT)\nMessage-Id: <200208052350.g75No7Yw097463@freefall.freebsd.org>\nX-Authentication-Warning: freefall.freebsd.org: nectar set sender to\n    security-advisories@freebsd.org using -f\nFrom: FreeBSD Security Advisories <security-advisories@freebsd.org>\nTo: Bugtraq <bugtraq@securityfocus.com>\nSubject: FreeBSD Security Advisory FreeBSD-SA-02:36.nfs\nReply-To: security-advisories@freebsd.org\n\n-----BEGIN PGP SIGNED MESSAGE-----\n\n=============================================================================\nFreeBSD-SA-02:36.nfs                                        Security Advisory\n                                                          The FreeBSD Project\n\nTopic:          Bug in NFS server code allows remote denial of service\n\nCategory:       core\nModule:         nfs\nAnnounced:      2002-08-05\nCredits:        Mike Junk <junk@isilon.com>\nAffects:        All releases prior to 4.6.1-RELEASE-p7\n                4.6-STABLE prior to the correction date\nCorrected:      2002-07-19 17:19:53 UTC (RELENG_4)\n                2002-08-01 19:31:55 UTC (RELENG_4_6)\n                2002-08-01 19:31:54 UTC (RELENG_4_5)\n                2002-08-01 19:31:54 UTC (RELENG_4_4)\nFreeBSD only:   NO\n\nI.   Background\n\nThe Network File System (NFS) allows a host to export some or all of\nits filesystems, or parts of them, so that other hosts can access them\nover the network and mount them as if they were on local disks.  NFS is\nbuilt on top of the Sun Remote Procedure Call (RPC) framework.\n\nII.  Problem Description\n\nA part of the NFS server code charged with handling incoming RPC\nmessages had an error which, when the server received a message with a\nzero-length payload, would cause it to reference the payload from the\nprevious message, creating a loop in the message chain.  This would\nlater cause an infinite loop in a different part of the NFS server\ncode which tried to traverse the chain.\n\nIII. Impact\n\nCertain Linux implementations of NFS produce zero-length RPC messages\nin some cases.  A FreeBSD system running an NFS server may lock up\nwhen such clients connect.\n\nAn attacker in a position to send RPC messages to an affected FreeBSD\nsystem can construct a sequence of malicious RPC messages that cause\nthe target system to lock up.\n\nIV.  Workaround\n\n1) Disable the NFS server: set the nfs_server_enable variable to \"NO\"\n   in /etc/rc.conf, and reboot.\n\n   Alternatively, if there are no active NFS clients (as listed by the\n   showmount(8) utility), just killing the mountd and nfsd processes\n   should suffice.\n\n2) Add firewall rules to block RPC traffic to the NFS server from\n   untrusted hosts.\n\nV.   Solution\n\nThe following patch has been verified to apply to FreeBSD 4.4, 4.5, and\n4.6 systems.\n\na) Download the relevant patch from the location below, and verify the\ndetached PGP signature using your PGP utility.\n\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:36/nfs.patch\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:36/nfs.patch.asc\n\nb) Apply the patch.\n\n# cd /usr/src\n# patch < /path/to/patch\n\nc) Recompile your kernel and modules as described in\n<URL:http://www.freebsd.org/handbook/kernelconfig.html> and reboot the\nsystem.\n\nVI.  Correction details\n\nThe following list contains the revision numbers of each file that was\ncorrected in FreeBSD.\n\nPath                                                             Revision\n  Branch\n- -------------------------------------------------------------------------\nsrc/sys/nfs/nfs_socket.c\n  RELENG_4                                                       1.60.2.5\n  RELENG_4_6                                                 1.60.2.3.2.1\n  RELENG_4_5                                                 1.60.2.1.6.1\n  RELENG_4_4                                                 1.60.2.3.4.1\n- -------------------------------------------------------------------------\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.0.7 (FreeBSD)\n\niQCVAwUBPU8NTVUuHi5z0oilAQHMZAP+L80QudeELKHfZYxG5PPf6cuWkreACavl\nLP1oJDHLWuw32K4tM0Y+v505t+U2/wGnl2dSqwkfemzxlhzfsmrbubQx8EFgO6sb\nnhEEtSfu4t81ylHTY+qEWFtRweB5A1tGJaYV67wybWZxulkYJ9qnRLKF4PToc0E3\nT1Y/CN0DNYA=\n=2YSa\n-----END PGP SIGNATURE-----\n\n\n"}